<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=windows-1251">
	<LINK REL="stylesheet" HREF="styles.css">
	<script language="javascript1.2" src="menu.js"></script>

</head>

<body background="img/fon1.gif" leftmargin=0 topmargin=0 onload="newTitle('4')">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
	<tr>
		<td><div align="justify">
		

<p> В S3 механизм, обеспечивающий продвижение по сценарию, реализован с использованием функций скриптового языка. Они обеспечивают открытие миссий для игрока, завершение миссий, переход от одного блока миссий к другому и т.п. </p>
<p> Для создания полноценного сценария следует создать структуру, которая включает в себя все составляющие сценария. </p>

<p> При встраивании собственной миссии в уже существующую сценарную игру большая часть сценарной структуры уже существует и поэтому остается только указать место новой миссии в этой структуре. </p>
<p> В текущей версии игры скрипт, обеспечивающий продвижение по сюжету, запускается на базе, на которую герой попадает после выполнения вводной миссии. При создании самостоятельного сценария рекомендуется детально ознакомиться с этим скриптом. Наличие зоны аналогичной базе облегчает создание механизма продвижения по сюжету. В принципе возможен перенос функциональности базы внутрь сюжетных миссий. Для этого полезно воспользоваться следующими скриптовыми функциями: </p>

<p> CheckScenarioBlockJustComplete ( nBlockOrder ) </p>
<p> CompleteAllBlocksBefore ( BlockOrder ) </p>
<p> GetNextBlockOrder </p>
<p> IsMissionTaken </p>
<p> IsReadyForNextBlock </p>
<p> IsScenarioBlockCompleteNumAvailableMissions() </p>
<p> NumMissionInBlock </p>
<p> ScenarioAddVisibleZone ( zoneName ) </p>
<p> TakeMission () </p>
<h2> <a name="level1"></a>	Сценарные ресурсы</h2>

<p><strong> Scenario</strong> — сценарий. Он служит вершиной иерархии, которая содержит все необходимое для организации набора миссий в сюжет, содержит ссылку на название, описание и список сценарных блоков. </p>
<p> При вызове этой ссылки список сценарных блоков выводится в отдельном окне редактора. </p>
<p><strong> Сценарные блоки</strong> – это набор из нескольких миссий, из которых определенное количество должно быть выполнено, прежде чем игрок получит доступ к миссиям следующего блока. В пределах одного блока миссии могут выполняться в любом порядке. Для того чтобы создать более линейный сценарий – цепочку миссий – нужно создать набор блоков, содержащих одну миссию. </p>
<p> Для создания нового блока в списке воспользуйтесь пунктом New Item контекстного меню. </p>
<p> Опиание блока состоит из номера блока, который определяет положение блока в цепочке, количества миссий, которые нужно выполнить для того чтобы завершить блок, и ссылки на список миссий,составляющих этот блок. При вызове этой ссылки список миссий блока открывается в отдельном окне редактора. </p>

<p><strong> Сценарные миссии - </strong> это игровые зоны с установленными для них параметрами, которые позволяют использовать эти карты в качестве части сценария. </p>
<p> Параметры отображаются при выборе миссии в списке. </p>
 <table width="600" border="1" cellspacing="0" cellpadding="5" bordercolor="#595F60">
  <tr>
    <td width="157" valign="top"><p> JournalRecordID </p></td>
    <td width="500" valign="top"><p> Ссылка на запись в журнале героя, которая выведется по окончании миссии </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> SmallDescription </p></td>
    <td width="500" valign="top"><p> Код миссии, для обращения к ней из консоли и скриптов. </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> Description </p></td>
    <td width="500" valign="top"><p> Трава </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> Item Slots </p></td>
    <td width="500" valign="top"><p> Не используется </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> Person Slots </p></td>
    <td width="500" valign="top"><p> Не используется </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> CluesMaxNumber </p></td>
    <td width="500" valign="top"><p> Не используется </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> TimeOfday </p></td>
    <td width="500" valign="top"><p> Время суток на зоне </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> ReparationForCivs </p></td>
    <td width="500" valign="top"><p> Размер штрафа за гибель одного гражданского лица на этой зоне. </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> Reward </p></td>
    <td width="500" valign="top"><p> Размер денежного вознаграждения за выполнение основного задания. </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> MobsLevel </p></td>
    <td width="500" valign="top"><p> Уровень врагов </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> CanPKBeUsed </p></td>
    <td width="500" valign="top"><p> Можно ли использовать на зоне бронекостюмы. </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> Goals </p></td>
    <td width="500" valign="top"><p> Ссылка на список заданий на зоне. </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> Templates </p></td>
    <td width="500" valign="top"><p> Ссылки на максимум три подзоны </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> Scenario </p></td>
    <td width="500" valign="top"><p> Ссылка на сценарий, которому принадлежит эта зона (должна указывать на сценарий AddOn \ Main ) </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> N а me </p></td>
    <td width="500" valign="top"><p> Ссылка на внутриигровое название зоны </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> ZoneDescriptionID </p></td>
    <td width="500" valign="top"><p> Ссылка на подробное описание зоны </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> PWLImageID </p></td>
    <td width="500" valign="top"><p> Ссылка на изображение, которое будет показываться при загрузке зоны. </p></td>
  </tr>
  <tr>
    <td width="157" valign="top"><p> PhotoID </p></td>
    <td width="500" valign="top"><p> Ссылка на изображение зоны на экране выбора миссии </p></td>
  </tr>
</table>

<p> Для создания новой миссии блока в списке миссий воспользуйтесь пунктом New Item контекстного меню. </p>

<p> При щелчке по ссылке, ведущей в список заданий, список откроется в отдельном окне редактора. </p>

<p><strong> Задания – </strong> цели, которые должны быть достигнуты игроком во время миссии для ее успешного выполнения<strong></strong></p>
<p> Параметры заданий отображаются при выборе задания в списке </p>

 <table width="600" border="1" cellspacing="0" cellpadding="5" bordercolor="#595F60">
  <tr>
    <td width="158" valign="top"><p> JournalRecordID </p></td>
    <td width="499" valign="top"><p> Ссылка на запись в журнале героя, которая выведется по выполнению задания миссии </p></td>
  </tr>
  <tr>
    <td width="158" valign="top"><p> BlocksLeaveZone </p></td>
    <td width="499" valign="top"><p> Необходимо ли выполнение данного задания для завершения миссии. </p></td>
  </tr>
  <tr>
    <td width="158" valign="top"><p> CompleteImmediately </p></td>
    <td width="499" valign="top"><p> Засчитывается ли задание немедленно или только по выходе с зоны. </p></td>
  </tr>
  <tr>
    <td width="158" valign="top"><p> VisibleByDefault </p></td>
    <td width="499" valign="top"><p> Отображается ли задание сразу по приходе на миссию(в противном случае должно показываться с использованием скрипта). </p></td>
  </tr>
  <tr>
    <td width="158" valign="top"><p> SmallDescription </p></td>
    <td width="499" valign="top"><p> Не используется </p></td>
  </tr>
  <tr>
    <td width="158" valign="top"><p> GoalType </p></td>
    <td width="499" valign="top"><p> Conclision – задается скриптом, Item – действие с предметом, Person - действие с персонажем, Object – действие с неподбираемым объектом на зоне </p></td>
  </tr>
  <tr>
    <td width="158" valign="top"><p> Reward </p></td>
    <td width="499" valign="top"><p> Дополнительное денежное вознаграждение за выполнение данного задания в дополнение к вознаграждению за миссию. </p></td>
  </tr>
  <tr>
    <td width="158" valign="top"><p> Tasks </p></td>
    <td width="499" valign="top"><p> Ссылки на максимум шесть подзаданий </p></td>
  </tr>
  <tr>
    <td width="158" valign="top"><p> Reward </p></td>
    <td width="499" valign="top"><p> Размер денежного вознаграждения за выполнение основного задания. </p></td>
  </tr>
  <tr>
    <td width="158" valign="top"><p> PersID </p></td>
    <td width="499" valign="top"><p> Персонаж, с которым нужно совершить действие для выполнения задания </p></td>
  </tr>
  <tr>
    <td width="158" valign="top"><p> ObjectID </p></td>
    <td width="499" valign="top"><p> Неподнимаемый объект, с которым нужно совершить действие для выполнения задания </p></td>
  </tr>
  <tr>
    <td width="158" valign="top"><p> GoaName </p></td>
    <td width="499" valign="top"><p> Ссылка на формулировку задания. </p></td>
  </tr>
  <tr>
    <td width="158" valign="top"><p> ItemID </p></td>
    <td width="499" valign="top"><p> Предмет, с которым нужно совершить действие для выполнения задания </p></td>
  </tr>
</table>

<p> Для выполнения задания некоторое действие должно быть совершено с персонажем, предметом или стационарным объектом на зоне. Выбор между ними производится параметром GoalType, а затем используются поля PersID, ItemID и ObjectID соответственно. </p>
<p> Действия, которые необходимо совершить, определяются подзаданиями. </p>
<p> Если условия выполнения задания не подходят под вышеописанные, то параметру GoalType присваивается значение Conclusion, а тип подзадания устанавливается в Complete By Script . </p>

<p> Для создания нового задания для миссии в списке заданий воспользуйтесь пунктом New Item контекстного меню. </p>
<p> При щелчке на поле с названием подзадания в отдельном окне редактора появится список подзаданий. </p>

<p><strong> Подзадания – </strong> это последовательность действий, которые должны быть совершены игроком для успешного выполнения задания. В ыполнение последнего подзадания означает выполнение всего задания. Каждое подзадание имеет 2 параметра: тип выполнения ( Tag ) и текстовое описание ( Description ). Тип выполнения можно выбрать из выпадающего списка: </p>

 <table width="600" border="1" cellspacing="0" cellpadding="5" bordercolor="#595F60">
  <tr>
    <td width="169" valign="top"><p> Carry out item </p></td>
    <td width="474" valign="top"><p> Вынести из зоны указанный предмет </p></td>
  </tr>
  <tr>
    <td width="169" valign="top"><p> Carry out person </p></td>
    <td width="474" valign="top"><p> Вынести на себе из зоны указанного персонажа </p></td>
  </tr>
  <tr>
    <td width="169" valign="top"><p> Complete by script </p></td>
    <td width="474" valign="top"><p> Задание/подзадание завершается по скрипту </p></td>
  </tr>
  <tr>
    <td width="169" valign="top"><p> Defend object </p></td>
    <td width="474" valign="top"><p> Предотвратить уничтожение указанного объекта </p></td>
  </tr>
  <tr>
    <td width="169" valign="top"><p> Destroy item carrier </p></td>
    <td width="474" valign="top"><p> Уничтожить персонажа, владеющего предметом </p></td>
  </tr>
  <tr>
    <td width="169" valign="top"><p> Destroy object </p></td>
    <td width="474" valign="top"><p> Уничтожить указанный объект </p></td>
  </tr>
  <tr>
    <td width="169" valign="top"><p> Find item </p></td>
    <td width="474" valign="top"><p> Найти (увидеть) указанный предмет </p></td>
  </tr>
  <tr>
    <td width="169" valign="top"><p> Find person </p></td>
    <td width="474" valign="top"><p> Найти (увидеть) указанного персонажа </p></td>
  </tr>
  <tr>
    <td width="169" valign="top"><p> Kill person </p></td>
    <td width="474" valign="top"><p> Уничтожить указанного персонажа </p></td>
  </tr>
  <tr>
    <td width="169" valign="top"><p> Stun person </p></td>
    <td width="474" valign="top"><p> Привести персонажа в бессознательное состояние </p></td>
  </tr>
  <tr>
    <td width="169" valign="top"><p> Take item </p></td>
    <td width="474" valign="top"><p> Взять предмет </p></td>
  </tr>
  <tr>
    <td width="169" valign="top"><p> Take person </p></td>
    <td width="474" valign="top"><p> Поднять тело персонажа </p></td>
  </tr>
</table>

<p> Текстовые строки, относящиеся к подзаданиям, размещаются в текстовых ресурсах. </p>
<p> Для создания нового подзадания в списке подзаданий воспользуйтесь пунктом New Item контекстного меню. </p>
<h2><a name="level2"></a>	 Выдача заданий (Goals) и подзаданий (Task) </h2>

<p> Если для миссии создана описаная выше структура заданий и подзаданий, то они автоматически будут отображаться во время миссии в соответствии с заданными параметрами. </p>
<p> Выдавать задания в миссии можно также с помощью скриптов. Чтобы можно было засчитывать выполнение задания из скрипта, у задания на закладке Tasks в поле Tag необходимо выставить параметр Complete by script . Для этого служат следующие скриптовые функции: </p>

<p> ScenarioSetGoalComplete ( nGoalID, bComplete [ true ]) </p>
<p> ScenarioSetTaskComplete(nGoalID, iTask, bComplete[true]) </p>


<h2><a name="level3"></a>	 Включение миссии в сценарий</a></h2>
<p> Прежде всего для включения миссии в сценарий необходимо внести ее в состав одного из уже заданных блоков сценария. </p>

<p> Также необходимо предоставить игроку интерфейс для навигации по доступным участкам сценария. Для этой цели используется глобальная карта и карта региона. Любая миссия должна быть привязана к этим двум картам. </p>

<p><strong> Глобальная карта (GlobalMaps) </strong></p>
<p><img src="img/properties_Globals.gif" alt="" width="354" height="188" hspace="5" vspace="5" border="0" align="right"> В игре есть единственная глобальная карта, на которой происходят все действия. В принципе, рисунок карты можно заменить, но логику ее использования переопределить нельзя. </p>

<p> Глобальная карта имеет следующие свойства: </p>
<p><em> Scenario</em><strong></strong> — принадлежность тому или иному сценарию. </p>
<p><em> BaseZoneID</em> — ссылка на зону, которая будет служить базой. </p>
<p><em> StartZoneID</em> — вводная миссия в сценарий </p>
<p><em> ScriptID</em><em> —</em> скрипт, <img src="img/sector.gif" alt="" width="53" height="65" hspace="5" vspace="5" border="0" align="left">активирующийся при загрузке глобальной кары </p>
<p><em> Background</em> — ссылка на текстуру фона </p>

<p><img src="img/properties_sector.gif" alt="" width="234" height="367" hspace="5" vspace="5" border="0" align="right"> Активные места на карте отмечены цветными многоугольниками, каждой фигуре соответствует своя карта региона. Эта фигура называется сектором. Крестиками на секторе отмечены узлы, за которые можно передвигать части фигуры, придавая ей нужную форму (фигура определяет координаты курсора мыши, вызывающего переход к карте региона при нажатии левой кнопки). </p>

<p> Чтобы вывести окно свойств сектора, щелкните правой кнопкой мыши по его границе (обратите внимание, что щелчок по внутренней части сектора не даст эффекта). </p>

<p><em> Chapter</em><em> — </em> принадлежность тому или иному региону (стране). </p>
<p><em> Image</em><em> — </em> картинка региона (вам нужно будет создать свою, если станете вносить новый регион на глобальную карту). </p>
<p> Image pos — координаты вывода картинки на экране </p>

<p> Остальные параметры в этом окне неактивны, т.к. они используются в свойствах зон на карте региона. </p>


<p><strong> Разделы (</strong><strong> Chapters</strong><strong> ) </strong></p>

<p> Разделы сценария, расположенные в закладке Chapters, представляют собой карты некоторых регионов, доступных с глобальной карты, на которых территориально расположены игровые зоны. </p>
<p> Описание карты региона включает в себя набор параметров: </p>
<p> список зон, которые будут отображаться в качестве походного лагеря, если команда игрока решит устроить привал; </p>
<p> ссылка на скрипт, который будет выполняться при заходе на эту карту; </p>
<p> ссылка на изображение, которое служит фоном для этой карты. </p>

<p> Определим тип и положение нашей игровой зоны на карте региона. Правым щелчком мыши в основном окне редактора выбираем <strong> New</strong><strong></strong><strong> sector</strong> из контекстного меню. Как и на глобальной карте, область, которая отображает зону следующего уровня, называется сектором. </p>

<p> Далее в контекстном меню, которое выводится щелчком правой кнопкой мыши по кромке созданного сектора, нужно выбрать пункт <strong> Zone</strong><strong></strong> и задать соответствующую этому сектору сценарную зону (значение параметра SmallDescription миссии). </p>

<p> Параметр Probability определяет вероятность появления данной миссии на карте региона, число обычно находится в пределах от 1 до 100 и имеет смысл только для случайных стычек. Если это значение равно 0, то миссия постоянно присутствует на карте (как все сценарные миссии). Сценарные миссии начинают отображаться на карте региона, как только мы получаем улику, ведущую на эту зону. Вид иконки игровой зоны определяется программной логикой. </p>

 <table width="600" border="1" cellspacing="0" cellpadding="5" bordercolor="#595F60">
  <tr>
    <td width="119" valign="top"><p><img src="img/icon_scenariozone.gif" alt="" width="50" height="50" border="0"></p></td>
    <td width="538" valign="top"><p> Так выглядит на карте региона сценарная зона. В игре на этом месте будет отображена иконка доступной зоны, если зона открыта, иконка пройденной зоны, если задание выполнено, и пустое место, если про зону пока не известно. </p></td>
  </tr>
  <tr>
    <td width="119" valign="top"><p><img src="img/icon_randomzone.gif" alt="" width="50" height="44" border="0"></p></td>
    <td width="538" valign="top"><p> Так выглядит зона случайных стычек ( random encountes ). В игре на этом месте будет появляться иконка противника пропорционально вероятности, заданной в поле Probability . </p></td>
  </tr>
</table>



<h2><a name="level4"></a>	 Отладка сценария</a></h2>

<p> Все ошибки могут происходить и на этапе проектирования сценария и при вводе связей из-за выбора неверных ссылок в редакторе. </p>

<p><strong> Проверка игровых зон </strong></p>
<p> Убедившись в правильности сценария, следует проверить все игровые зоны (т.е. темплейты) на работоспособность и соответствие намеченному сценарию. Предполагается, что вы собираете сценарий из готовых работающих темплейтов, поэтому проблем с загрузкой темплейта в редакторе у вас быть не должно. Загрузите по очереди все зоны, использованные в сценарии <strong> Templates</strong><strong> . </strong> При<strong></strong>успешной загрузке визуально проверьте правильность указанных темплейтов. </p>

<p><img src="img/find_ID.gif" alt="" width="404" height="122" hspace="5" vspace="5" border="0" align="right"> Искать темплейты сценарных зон в редакторе по ID удобно с помощью функции поиска Ctrl + F ( Find ) или через контекстное меню, вызываемое по нажатию правой кнопки в активной ресурсной закладке. В диалоговом окне Item ID — это ID темплейта, а Variant ID — это ID варианта данного темплейта. </p>

<p> Запустите темплейты сценарных зон в интерфейсе редактора с персонажами по умолчанию и убедитесь, что игровые зоны не содержат ошибок проходимости (см. раздел 3). После этого остается проверить работоспособность заданий. </p>

		
		
			

		
		</div>
		</td>
	</tr>	
</table>



</body>
</html>
